"use strict";!function(i){cookie.get("uername")&&(i(".first-li b").html(cookie.get("uername")+"先生，您已登陆"),i(".first-li a:first").attr({href:"#"}),i(".first-li a:first").on("click",function(){alert("您已登陆，请勿重复操作")}),i(".first-li a:last").css({display:"none"}),i(".first-li .seconed").css({display:"",color:"#666"}).on("click",function(){i(".first-li b").html("访客，请您登录"),i(this).css({display:"none"}),cookie.remove("uername"),i(".first-li a:last").css({display:""}),cookie.remove("uername"),location.reload()}),i(".first-li a:last").attr({display:"none"}))}(jQuery),function(p){var o=cookie.get("shop");if(o)var h=(o=JSON.parse(o)).map(function(i){return i.id}).join();p.ajax({type:"get",url:"../php/Car.php",data:{idList:h},dataType:"json",success:function(i){var e="";i.forEach(function(s){var i=JSON.parse(s.pic),n=o.filter(function(i,n){return i.id===s.id});e='\n                <div class="car">\n                     <div class="inp"><input type="checkbox" class="in1"></div>\n                     <div><img src="'+i[0].src+'" alt="" style="width: 100px;height:100px;"></div>\n                     <div class="title"><a href="">'+s.title+'</a></div>\n                     <div class="price">￥<i>'+s.price+'</i></div> \n                      <div class="num"><span id="sp_l">-</span><input type="text" class="change" value="'+n[0].num+'"><span id="sp_r">+</span></div>\n                     <div class="all-num">￥<i>'+(n[0].num*s.price).toFixed(2)+'</i></div>\n                     <div id="'+s.id+'" class="del '+s.id+'">删除</div>\n                </div>\n                ',p(".car-wrap").append(e)}),p(".del").on("click",function(){p(this).parent().remove();var e=p(this)[0];p.each(o,function(i,n){if(p(e).attr("id")==n.id){var s=o.indexOf(n);o.splice(s,1),o=JSON.stringify(o),cookie.set("shop",o)}})});var n=p("input:checkbox").not("#in0"),s=p("#in0"),t=p(".all-price i"),a=p(".car"),l=p(".car span"),c=p(".del_all"),r=null;p(".car span").bind("selectstart",function(){return!1}),l.on("click",function(){if(console.log(cookie.get("shop")),console.log(h),"sp_r"===p(this)[0].id){var i=parseInt(p(this).siblings(".change").val());p(this).siblings(".change").val(i+1),summ=parseInt(parseInt(p(this).parent().siblings(".price").find("i").html()))*parseInt(p(this).siblings(".change").val()),p(this).parent().siblings(".all-num").find("i").html(summ.toFixed(2)),!0===p(this).parent().siblings(".inp").find(".in1").prop("checked")&&(r+=parseInt(p(this).parent().siblings(".price").find("i").html()),t.html(r))}else if("sp_l"===p(this)[0].id){var n=parseInt(p(this).siblings(".change").val());1<n?(p(this).siblings(".change").val(n-1),summ=parseInt(parseInt(p(this).parent().siblings(".price").find("i").html()))*parseInt(p(this).siblings(".change").val()),p(this).parent().siblings(".all-num").find("i").html(summ.toFixed(2)),!0===p(this).parent().siblings(".inp").find(".in1").prop("checked")&&(r-=parseInt(p(this).parent().siblings(".price").find("i").html()),t.html(r))):(p(this).siblings(".change").val(1),p(this).parent().siblings(".all-num").find("i").html(p(this).parent().siblings(".price").find("i").html()))}}),!0===s.prop("checked")&&c.on("click",function(){cookie.remove("shop"),a.empty(),location.reload()}),s.on("click",function(){!0===s.prop("checked")?(c.on("click",function(){cookie.remove("shop"),a.empty(),location.reload()}),p.each(n,function(i,n){!1===p(n).prop("checked")&&(r+=parseInt(p(this).parent().parent().find(".all-num i").html()))}),console.log(r),t.html(r),n.prop("checked",!0)):(r=0,t.html(r),n.prop("checked",!1))}),n.on("click",function(){var i=parseInt(p(this).parent().parent().find(".all-num i").html());!0===p(this).prop("checked")?r+=i:r-=i,t.html(r),n.length===p("input:checked").not("#in0").length?s.prop("checked",!0):s.prop("checked",!1)})}})}(jQuery);